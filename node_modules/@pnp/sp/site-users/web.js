import { __awaiter } from "tslib";
import { addProp, body } from "@pnp/odata";
import { _Web, Web } from "../webs/types.js";
import { SiteUsers, SiteUser } from "./types.js";
import { odataUrlFrom } from "../odata.js";
import { spPost } from "../operations.js";
addProp(_Web, "siteUsers", SiteUsers);
addProp(_Web, "currentUser", SiteUser, "currentuser");
_Web.prototype.ensureUser = function (logonName) {
    return __awaiter(this, void 0, void 0, function* () {
        const data = yield spPost(this.clone(Web, "ensureuser"), body({ logonName }));
        return {
            data,
            user: SiteUser(odataUrlFrom(data)),
        };
    });
};
_Web.prototype.getUserById = function (id) {
    return SiteUser(this, `getUserById(${id})`);
};
//# sourceMappingURL=web.js.map
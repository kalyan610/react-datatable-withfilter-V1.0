import { __awaiter, __generator } from "tslib";
import { _ClientsidePage } from "../clientside-pages/types";
import { Comment } from "./types";
import { spODataEntity } from "../odata";
import { tag } from "../telemetry";
import { Item } from "../items";
_ClientsidePage.prototype.addComment = function (info) {
    return __awaiter(this, void 0, void 0, function () {
        var item;
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, this.getItem()];
                case 1:
                    item = _a.sent();
                    return [2 /*return*/, item.comments.add(info)];
            }
        });
    });
};
_ClientsidePage.prototype.getCommentById = function (id) {
    return __awaiter(this, void 0, void 0, function () {
        var item;
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, this.getItem()];
                case 1:
                    item = _a.sent();
                    return [2 /*return*/, item.comments.getById(id).usingParser(spODataEntity(Comment))()];
            }
        });
    });
};
_ClientsidePage.prototype.clearComments = function () {
    return __awaiter(this, void 0, void 0, function () {
        var item;
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, this.getItem()];
                case 1:
                    item = _a.sent();
                    return [2 /*return*/, item.comments.clear()];
            }
        });
    });
};
_ClientsidePage.prototype.getComments = function () {
    return __awaiter(this, void 0, void 0, function () {
        var item;
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, this.getItem()];
                case 1:
                    item = _a.sent();
                    return [2 /*return*/, tag.configure(item, "").comments()];
            }
        });
    });
};
_ClientsidePage.prototype.like = function () {
    return __awaiter(this, void 0, void 0, function () {
        var item;
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, this.getItem("ID")];
                case 1:
                    item = _a.sent();
                    return [2 /*return*/, item.like()];
            }
        });
    });
};
_ClientsidePage.prototype.unlike = function () {
    return __awaiter(this, void 0, void 0, function () {
        var item;
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, this.getItem("ID")];
                case 1:
                    item = _a.sent();
                    return [2 /*return*/, item.unlike()];
            }
        });
    });
};
_ClientsidePage.prototype.getLikedByInformation = function () {
    return __awaiter(this, void 0, void 0, function () {
        var item;
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, this.getItem("ID")];
                case 1:
                    item = _a.sent();
                    return [2 /*return*/, item.getLikedByInformation()];
            }
        });
    });
};
_ClientsidePage.prototype.enableComments = function () {
    return __awaiter(this, void 0, void 0, function () {
        var _this = this;
        return __generator(this, function (_a) {
            tag.configure(this, "csp.enableComments");
            return [2 /*return*/, this.setCommentsOn(true).then(function (r) {
                    _this.commentsDisabled = false;
                    return r;
                })];
        });
    });
};
_ClientsidePage.prototype.disableComments = function () {
    return __awaiter(this, void 0, void 0, function () {
        var _this = this;
        return __generator(this, function (_a) {
            tag.configure(this, "csp.disableComments");
            return [2 /*return*/, this.setCommentsOn(false).then(function (r) {
                    _this.commentsDisabled = true;
                    return r;
                })];
        });
    });
};
_ClientsidePage.prototype.setCommentsOn = function (on) {
    return __awaiter(this, void 0, void 0, function () {
        var item;
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0: return [4 /*yield*/, this.getItem()];
                case 1:
                    item = _a.sent();
                    return [2 /*return*/, Item(item, "SetCommentsDisabled(" + !on + ")").update({})];
            }
        });
    });
};
//# sourceMappingURL=clientside-page.js.map
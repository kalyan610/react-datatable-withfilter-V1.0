{"version":3,"sources":["components/HierarchicalTree/HierarchicalTreeItem.tsx"],"names":["hierarchicalTreeItemClassName","hierarchicalTreeItemSlotClassNames","subtree","HierarchicalTreeItem","props","context","displayName","telemetry","setStart","setEnd","items","title","renderItemTitle","open","exclusive","children","className","design","styles","variables","ElementType","unhandledProps","handledProps","actionHandlers","performClick","e","preventDefault","stopPropagation","receiveFocus","eventComesFromChildItem","itemRef","current","focus","collapse","handleTitleClick","expand","focusSubtree","element","treeRef","getA11yProps","accessibility","debugName","mapPropsToBehavior","hasItems","length","rtl","React","useRef","mapPropsToInlineStyles","classes","currentTarget","target","handleTitleOverrides","predefinedProps","onClick","titleProps","renderContent","hasSubtree","HierarchicalTreeTitle","create","defaultProps","as","render","overrideProps","HierarchicalTree","hierarchicalSubtreeBehavior","root","rtlTextContainer","getAttributes","forElements","propTypes","commonPropTypes","createCommon","content","customPropTypes","collectionShorthand","index","PropTypes","number","bool","onTitleClick","func","itemShorthand","hierarchicalTreeItemBehavior","Object","keys","Component","mappedProp"],"mappings":"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","sourcesContent":["import {\n  Accessibility,\n  hierarchicalTreeItemBehavior,\n  hierarchicalSubtreeBehavior,\n  HierarchicalTreeItemBehaviorProps,\n} from '@fluentui/accessibility';\nimport {\n  ComponentWithAs,\n  getFirstFocusable,\n  useTelemetry,\n  useFluentContext,\n  getElementType,\n  useUnhandledProps,\n  useAccessibility,\n  useStyles,\n} from '@fluentui/react-bindings';\nimport * as customPropTypes from '@fluentui/react-proptypes';\nimport { Ref } from '@fluentui/react-component-ref';\nimport * as _ from 'lodash';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\n\nimport { HierarchicalTree, HierarchicalTreeProps } from './HierarchicalTree';\nimport { HierarchicalTreeTitle, HierarchicalTreeTitleProps } from './HierarchicalTreeTitle';\nimport {\n  childrenExist,\n  createShorthandFactory,\n  commonPropTypes,\n  UIComponentProps,\n  ChildrenComponentProps,\n  rtlTextContainer,\n} from '../../utils';\nimport {\n  ComponentEventHandler,\n  ShorthandRenderFunction,\n  ShorthandValue,\n  ShorthandCollection,\n  FluentComponentStaticProps,\n} from '../../types';\n\nexport interface HierarchicalTreeItemSlotClassNames {\n  subtree: string;\n}\n\nexport interface HierarchicalTreeItemProps extends UIComponentProps, ChildrenComponentProps {\n  /** Accessibility behavior if overridden by the user. */\n  accessibility?: Accessibility<HierarchicalTreeItemBehaviorProps>;\n\n  /** Only allow one subtree to be open at a time. */\n  exclusive?: boolean;\n\n  /** The index of the item among its sibbling */\n  index?: number;\n\n  /** Array of props for sub tree. */\n  items?: ShorthandValue<HierarchicalTreeProps> | ShorthandCollection<HierarchicalTreeItemProps>;\n\n  /** Called when a tree title is clicked. */\n  onTitleClick?: ComponentEventHandler<HierarchicalTreeItemProps>;\n\n  /** Whether or not the subtree of the item is in the open state. */\n  open?: boolean;\n\n  /**\n   * A custom render iterator for rendering each Accordion panel title.\n   * The default component, props, and children are available for each panel title.\n   *\n   * @param Component - The computed component for this slot.\n   * @param props - The computed props for this slot.\n   * @param children - The computed children for this slot.\n   */\n  renderItemTitle?: ShorthandRenderFunction<HierarchicalTreeTitleProps>;\n\n  /** Properties for TreeTitle. */\n  title?: ShorthandValue<HierarchicalTreeTitleProps>;\n}\n\nexport const hierarchicalTreeItemClassName = 'ui-hierarchicaltree__item';\nexport const hierarchicalTreeItemSlotClassNames: HierarchicalTreeItemSlotClassNames = {\n  subtree: `${hierarchicalTreeItemClassName}__subtree`,\n};\n\nexport type HierarchicalTreeItemStyles = never;\n\n/**\n * A TreeItem renders an item of a Tree.\n *\n * @accessibility\n * Implements [ARIA TreeView](https://www.w3.org/TR/wai-aria-practices-1.1/#TreeView) design pattern.\n */\nexport const HierarchicalTreeItem: ComponentWithAs<'li', HierarchicalTreeItemProps> &\n  FluentComponentStaticProps<HierarchicalTreeItemProps> = props => {\n  const context = useFluentContext();\n  const { setStart, setEnd } = useTelemetry(HierarchicalTreeItem.displayName, context.telemetry);\n  setStart();\n  const { items, title, renderItemTitle, open, exclusive, children, className, design, styles, variables } = props;\n  const ElementType = getElementType(props);\n  const unhandledProps = useUnhandledProps(HierarchicalTreeItem.handledProps, props);\n\n  const actionHandlers = {\n    performClick: e => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      _.invoke(props, 'onTitleClick', e, props);\n    },\n    receiveFocus: e => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      // Focuses the title if the event comes from a child item.\n      if (eventComesFromChildItem(e)) {\n        itemRef.current.focus();\n      }\n    },\n    collapse: e => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      // Handle click on title if the keyboard event was dispatched on that title\n      if (!eventComesFromChildItem(e)) {\n        handleTitleClick(e);\n      }\n    },\n    expand: e => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      handleTitleClick(e);\n    },\n    focusSubtree: e => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      const element = getFirstFocusable(treeRef.current, treeRef.current, true);\n      if (element) {\n        element.focus();\n      }\n    },\n  };\n  const getA11yProps = useAccessibility<HierarchicalTreeItemBehaviorProps>(props.accessibility, {\n    debugName: HierarchicalTreeItem.displayName,\n    actionHandlers,\n    mapPropsToBehavior: () => ({\n      hasItems: items && !!(items as HierarchicalTreeItemProps[]).length,\n      open,\n    }),\n    rtl: context.rtl,\n  });\n\n  const itemRef = React.useRef<HTMLElement>();\n  const treeRef = React.useRef<HTMLElement>();\n\n  const { classes } = useStyles<HierarchicalTreeItemStyles>(HierarchicalTreeItem.displayName, {\n    className: hierarchicalTreeItemClassName,\n    mapPropsToInlineStyles: () => ({\n      className,\n      design,\n      styles,\n      variables,\n    }),\n    rtl: context.rtl,\n  });\n\n  const eventComesFromChildItem = e => {\n    return e.currentTarget !== e.target;\n  };\n\n  const handleTitleClick = e => {\n    _.invoke(props, 'onTitleClick', e, props);\n  };\n\n  const handleTitleOverrides = (predefinedProps: HierarchicalTreeTitleProps) => ({\n    onClick: (e, titleProps) => {\n      handleTitleClick(e);\n      _.invoke(predefinedProps, 'onClick', e, titleProps);\n    },\n  });\n\n  const renderContent = () => {\n    const hasSubtree = !_.isNil(items);\n\n    return (\n      <>\n        {HierarchicalTreeTitle.create(title, {\n          defaultProps: () => ({\n            open,\n            hasSubtree,\n            as: hasSubtree ? 'span' : 'a',\n          }),\n          render: renderItemTitle,\n          overrideProps: handleTitleOverrides,\n        })}\n        {hasSubtree && open && (\n          <Ref innerRef={treeRef}>\n            {HierarchicalTree.create(items, {\n              defaultProps: () =>\n                getA11yProps('item', {\n                  accessibility: hierarchicalSubtreeBehavior,\n                  className: hierarchicalTreeItemSlotClassNames.subtree,\n                  exclusive,\n                  renderItemTitle,\n                }),\n            })}\n          </Ref>\n        )}\n      </>\n    );\n  };\n\n  const element = (\n    <Ref innerRef={itemRef}>\n      <ElementType\n        {...getA11yProps('root', {\n          className: classes.root,\n          ...unhandledProps,\n          ...rtlTextContainer.getAttributes({ forElements: [children] }),\n        })}\n      >\n        {childrenExist(children) ? children : renderContent()}\n      </ElementType>\n    </Ref>\n  );\n\n  setEnd();\n  return element;\n};\n\nHierarchicalTreeItem.displayName = 'HierarchicalTreeItem';\n\nHierarchicalTreeItem.propTypes = {\n  ...commonPropTypes.createCommon({\n    content: false,\n  }),\n  items: customPropTypes.collectionShorthand,\n  index: PropTypes.number,\n  exclusive: PropTypes.bool,\n  onTitleClick: PropTypes.func,\n  open: PropTypes.bool,\n  renderItemTitle: PropTypes.func,\n  title: customPropTypes.itemShorthand,\n};\n\nHierarchicalTreeItem.defaultProps = {\n  as: 'li',\n  accessibility: hierarchicalTreeItemBehavior,\n};\n\nHierarchicalTreeItem.handledProps = Object.keys(HierarchicalTreeItem.propTypes) as any;\n\nHierarchicalTreeItem.create = createShorthandFactory({\n  Component: HierarchicalTreeItem,\n  mappedProp: 'title',\n});\n"],"file":"HierarchicalTreeItem.js"}
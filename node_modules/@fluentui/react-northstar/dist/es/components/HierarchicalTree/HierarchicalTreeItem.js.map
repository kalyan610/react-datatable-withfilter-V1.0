{"version":3,"sources":["components/HierarchicalTree/HierarchicalTreeItem.tsx"],"names":["hierarchicalTreeItemBehavior","hierarchicalSubtreeBehavior","getFirstFocusable","useTelemetry","useFluentContext","getElementType","useUnhandledProps","useAccessibility","useStyles","customPropTypes","Ref","PropTypes","React","HierarchicalTree","HierarchicalTreeTitle","childrenExist","createShorthandFactory","commonPropTypes","rtlTextContainer","hierarchicalTreeItemClassName","hierarchicalTreeItemSlotClassNames","subtree","HierarchicalTreeItem","props","context","displayName","telemetry","setStart","setEnd","items","title","renderItemTitle","open","exclusive","children","className","design","styles","variables","ElementType","unhandledProps","handledProps","actionHandlers","performClick","e","preventDefault","stopPropagation","receiveFocus","eventComesFromChildItem","itemRef","current","focus","collapse","handleTitleClick","expand","focusSubtree","element","treeRef","getA11yProps","accessibility","debugName","mapPropsToBehavior","hasItems","length","rtl","useRef","mapPropsToInlineStyles","classes","currentTarget","target","handleTitleOverrides","predefinedProps","onClick","titleProps","renderContent","hasSubtree","create","defaultProps","as","render","overrideProps","root","getAttributes","forElements","propTypes","createCommon","content","collectionShorthand","index","number","bool","onTitleClick","func","itemShorthand","Object","keys","Component","mappedProp"],"mappings":";;AAAA,SAEEA,4BAFF,EAGEC,2BAHF,QAKO,yBALP;AAMA,SAEEC,iBAFF,EAGEC,YAHF,EAIEC,gBAJF,EAKEC,cALF,EAMEC,iBANF,EAOEC,gBAPF,EAQEC,SARF,QASO,0BATP;AAUA,OAAO,KAAKC,eAAZ,MAAiC,2BAAjC;AACA,SAASC,GAAT,QAAoB,+BAApB;AAEA,OAAO,KAAKC,SAAZ,MAA2B,YAA3B;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AAEA,SAASC,gBAAT,QAAwD,oBAAxD;AACA,SAASC,qBAAT,QAAkE,yBAAlE;AACA,SACEC,aADF,EAEEC,sBAFF,EAGEC,eAHF,EAMEC,gBANF,QAOO,aAPP;AAqDA,OAAO,IAAMC,6BAA6B,GAAG,2BAAtC;AACP,OAAO,IAAMC,kCAAsE,GAAG;AACpFC,EAAAA,OAAO,EAAKF,6BAAL;AAD6E,CAA/E;;AAMP;;;;;;AAMA,OAAO,IAAMG,oBAAN;AAAA,MAAMA,oBAC0C,GAAG,SAD7CA,oBAC6C,CAAAC,KAAK,EAAI;AACjE,QAAMC,OAAO,GAAGpB,gBAAgB,EAAhC;;AADiE,wBAEpCD,YAAY,CAACmB,oBAAoB,CAACG,WAAtB,EAAmCD,OAAO,CAACE,SAA3C,CAFwB;AAAA,QAEzDC,QAFyD,iBAEzDA,QAFyD;AAAA,QAE/CC,MAF+C,iBAE/CA,MAF+C;;AAGjED,IAAAA,QAAQ;AAHyD,QAIzDE,KAJyD,GAI0CN,KAJ1C,CAIzDM,KAJyD;AAAA,QAIlDC,KAJkD,GAI0CP,KAJ1C,CAIlDO,KAJkD;AAAA,QAI3CC,eAJ2C,GAI0CR,KAJ1C,CAI3CQ,eAJ2C;AAAA,QAI1BC,IAJ0B,GAI0CT,KAJ1C,CAI1BS,IAJ0B;AAAA,QAIpBC,SAJoB,GAI0CV,KAJ1C,CAIpBU,SAJoB;AAAA,QAITC,QAJS,GAI0CX,KAJ1C,CAITW,QAJS;AAAA,QAICC,SAJD,GAI0CZ,KAJ1C,CAICY,SAJD;AAAA,QAIYC,MAJZ,GAI0Cb,KAJ1C,CAIYa,MAJZ;AAAA,QAIoBC,MAJpB,GAI0Cd,KAJ1C,CAIoBc,MAJpB;AAAA,QAI4BC,SAJ5B,GAI0Cf,KAJ1C,CAI4Be,SAJ5B;AAKjE,QAAMC,WAAW,GAAGlC,cAAc,CAACkB,KAAD,CAAlC;AACA,QAAMiB,cAAc,GAAGlC,iBAAiB,CAACgB,oBAAoB,CAACmB,YAAtB,EAAoClB,KAApC,CAAxC;AAEA,QAAMmB,cAAc,GAAG;AACrBC,MAAAA,YAAY,EAAE,sBAAAC,CAAC,EAAI;AACjBA,QAAAA,CAAC,CAACC,cAAF;AACAD,QAAAA,CAAC,CAACE,eAAF;;AAEA,gBAASvB,KAAT,EAAgB,cAAhB,EAAgCqB,CAAhC,EAAmCrB,KAAnC;AACD,OANoB;AAOrBwB,MAAAA,YAAY,EAAE,sBAAAH,CAAC,EAAI;AACjBA,QAAAA,CAAC,CAACC,cAAF;AACAD,QAAAA,CAAC,CAACE,eAAF,GAFiB,CAIjB;;AACA,YAAIE,uBAAuB,CAACJ,CAAD,CAA3B,EAAgC;AAC9BK,UAAAA,OAAO,CAACC,OAAR,CAAgBC,KAAhB;AACD;AACF,OAfoB;AAgBrBC,MAAAA,QAAQ,EAAE,kBAAAR,CAAC,EAAI;AACbA,QAAAA,CAAC,CAACC,cAAF;AACAD,QAAAA,CAAC,CAACE,eAAF,GAFa,CAIb;;AACA,YAAI,CAACE,uBAAuB,CAACJ,CAAD,CAA5B,EAAiC;AAC/BS,UAAAA,gBAAgB,CAACT,CAAD,CAAhB;AACD;AACF,OAxBoB;AAyBrBU,MAAAA,MAAM,EAAE,gBAAAV,CAAC,EAAI;AACXA,QAAAA,CAAC,CAACC,cAAF;AACAD,QAAAA,CAAC,CAACE,eAAF;AAEAO,QAAAA,gBAAgB,CAACT,CAAD,CAAhB;AACD,OA9BoB;AA+BrBW,MAAAA,YAAY,EAAE,sBAAAX,CAAC,EAAI;AACjBA,QAAAA,CAAC,CAACC,cAAF;AACAD,QAAAA,CAAC,CAACE,eAAF;AAEA,YAAMU,OAAO,GAAGtD,iBAAiB,CAACuD,OAAO,CAACP,OAAT,EAAkBO,OAAO,CAACP,OAA1B,EAAmC,IAAnC,CAAjC;;AACA,YAAIM,OAAJ,EAAa;AACXA,UAAAA,OAAO,CAACL,KAAR;AACD;AACF;AAvCoB,KAAvB;AAyCA,QAAMO,YAAY,GAAGnD,gBAAgB,CAAoCgB,KAAK,CAACoC,aAA1C,EAAyD;AAC5FC,MAAAA,SAAS,EAAEtC,oBAAoB,CAACG,WAD4D;AAE5FiB,MAAAA,cAAc,EAAdA,cAF4F;AAG5FmB,MAAAA,kBAAkB,EAAE;AAAA,eAAO;AACzBC,UAAAA,QAAQ,EAAEjC,KAAK,IAAI,CAAC,CAAEA,KAAD,CAAuCkC,MADnC;AAEzB/B,UAAAA,IAAI,EAAJA;AAFyB,SAAP;AAAA,OAHwE;AAO5FgC,MAAAA,GAAG,EAAExC,OAAO,CAACwC;AAP+E,KAAzD,CAArC;AAUA,QAAMf,OAAO,GAAGrC,KAAK,CAACqD,MAAN,EAAhB;AACA,QAAMR,OAAO,GAAG7C,KAAK,CAACqD,MAAN,EAAhB;;AA5DiE,qBA8D7CzD,SAAS,CAA6Bc,oBAAoB,CAACG,WAAlD,EAA+D;AAC1FU,MAAAA,SAAS,EAAEhB,6BAD+E;AAE1F+C,MAAAA,sBAAsB,EAAE;AAAA,eAAO;AAC7B/B,UAAAA,SAAS,EAATA,SAD6B;AAE7BC,UAAAA,MAAM,EAANA,MAF6B;AAG7BC,UAAAA,MAAM,EAANA,MAH6B;AAI7BC,UAAAA,SAAS,EAATA;AAJ6B,SAAP;AAAA,OAFkE;AAQ1F0B,MAAAA,GAAG,EAAExC,OAAO,CAACwC;AAR6E,KAA/D,CA9DoC;AAAA,QA8DzDG,OA9DyD,cA8DzDA,OA9DyD;;AAyEjE,QAAMnB,uBAAuB,GAAG,SAA1BA,uBAA0B,CAAAJ,CAAC,EAAI;AACnC,aAAOA,CAAC,CAACwB,aAAF,KAAoBxB,CAAC,CAACyB,MAA7B;AACD,KAFD;;AAIA,QAAMhB,gBAAgB,GAAG,SAAnBA,gBAAmB,CAAAT,CAAC,EAAI;AAC5B,cAASrB,KAAT,EAAgB,cAAhB,EAAgCqB,CAAhC,EAAmCrB,KAAnC;AACD,KAFD;;AAIA,QAAM+C,oBAAoB,GAAG,SAAvBA,oBAAuB,CAACC,eAAD;AAAA,aAAkD;AAC7EC,QAAAA,OAAO,EAAE,iBAAC5B,CAAD,EAAI6B,UAAJ,EAAmB;AAC1BpB,UAAAA,gBAAgB,CAACT,CAAD,CAAhB;;AACA,kBAAS2B,eAAT,EAA0B,SAA1B,EAAqC3B,CAArC,EAAwC6B,UAAxC;AACD;AAJ4E,OAAlD;AAAA,KAA7B;;AAOA,QAAMC,aAAa,GAAG,SAAhBA,aAAgB,GAAM;AAC1B,UAAMC,UAAU,GAAG,CAAC,OAAQ9C,KAAR,CAApB;AAEA,0BACE,0CACGf,qBAAqB,CAAC8D,MAAtB,CAA6B9C,KAA7B,EAAoC;AACnC+C,QAAAA,YAAY,EAAE;AAAA,iBAAO;AACnB7C,YAAAA,IAAI,EAAJA,IADmB;AAEnB2C,YAAAA,UAAU,EAAVA,UAFmB;AAGnBG,YAAAA,EAAE,EAAEH,UAAU,GAAG,MAAH,GAAY;AAHP,WAAP;AAAA,SADqB;AAMnCI,QAAAA,MAAM,EAAEhD,eAN2B;AAOnCiD,QAAAA,aAAa,EAAEV;AAPoB,OAApC,CADH,EAUGK,UAAU,IAAI3C,IAAd,iBACC,oBAAC,GAAD;AAAK,QAAA,QAAQ,EAAEyB;AAAf,SACG5C,gBAAgB,CAAC+D,MAAjB,CAAwB/C,KAAxB,EAA+B;AAC9BgD,QAAAA,YAAY,EAAE;AAAA,iBACZnB,YAAY,CAAC,MAAD,EAAS;AACnBC,YAAAA,aAAa,EAAE1D,2BADI;AAEnBkC,YAAAA,SAAS,EAAEf,kCAAkC,CAACC,OAF3B;AAGnBY,YAAAA,SAAS,EAATA,SAHmB;AAInBF,YAAAA,eAAe,EAAfA;AAJmB,WAAT,CADA;AAAA;AADgB,OAA/B,CADH,CAXJ,CADF;AA0BD,KA7BD;;AA+BA,QAAMyB,OAAO,gBACX,oBAAC,GAAD;AAAK,MAAA,QAAQ,EAAEP;AAAf,oBACE,oBAAC,WAAD,EACMS,YAAY,CAAC,MAAD;AACdvB,MAAAA,SAAS,EAAEgC,OAAO,CAACc;AADL,OAEXzC,cAFW,EAGXtB,gBAAgB,CAACgE,aAAjB,CAA+B;AAAEC,MAAAA,WAAW,EAAE,CAACjD,QAAD;AAAf,KAA/B,CAHW,EADlB,EAOGnB,aAAa,CAACmB,QAAD,CAAb,GAA0BA,QAA1B,GAAqCwC,aAAa,EAPrD,CADF,CADF;AAcA9C,IAAAA,MAAM;AACN,WAAO4B,OAAP;AACD,GAxIM;;AA0IPlC,EAAAA,oBAAoB,CAACG,WAArB,GAAmC,sBAAnC;AAEAH,EAAAA,oBAAoB,CAAC8D,SAArB,qBACKnE,eAAe,CAACoE,YAAhB,CAA6B;AAC9BC,IAAAA,OAAO,EAAE;AADqB,GAA7B,CADL;AAIEzD,IAAAA,KAAK,EAAEpB,eAAe,CAAC8E,mBAJzB;AAKEC,IAAAA,KAAK,EAAE7E,SAAS,CAAC8E,MALnB;AAMExD,IAAAA,SAAS,EAAEtB,SAAS,CAAC+E,IANvB;AAOEC,IAAAA,YAAY,EAAEhF,SAAS,CAACiF,IAP1B;AAQE5D,IAAAA,IAAI,EAAErB,SAAS,CAAC+E,IARlB;AASE3D,IAAAA,eAAe,EAAEpB,SAAS,CAACiF,IAT7B;AAUE9D,IAAAA,KAAK,EAAErB,eAAe,CAACoF;AAVzB;AAaAvE,EAAAA,oBAAoB,CAACuD,YAArB,GAAoC;AAClCC,IAAAA,EAAE,EAAE,IAD8B;AAElCnB,IAAAA,aAAa,EAAE3D;AAFmB,GAApC;AAKAsB,EAAAA,oBAAoB,CAACmB,YAArB,GAAoCqD,MAAM,CAACC,IAAP,CAAYzE,oBAAoB,CAAC8D,SAAjC,CAApC;AAEA9D,EAAAA,oBAAoB,CAACsD,MAArB,GAA8B5D,sBAAsB,CAAC;AACnDgF,IAAAA,SAAS,EAAE1E,oBADwC;AAEnD2E,IAAAA,UAAU,EAAE;AAFuC,GAAD,CAApD;AAhKO,SAAM3E,oBAAN;AAAA","sourcesContent":["import {\n  Accessibility,\n  hierarchicalTreeItemBehavior,\n  hierarchicalSubtreeBehavior,\n  HierarchicalTreeItemBehaviorProps,\n} from '@fluentui/accessibility';\nimport {\n  ComponentWithAs,\n  getFirstFocusable,\n  useTelemetry,\n  useFluentContext,\n  getElementType,\n  useUnhandledProps,\n  useAccessibility,\n  useStyles,\n} from '@fluentui/react-bindings';\nimport * as customPropTypes from '@fluentui/react-proptypes';\nimport { Ref } from '@fluentui/react-component-ref';\nimport * as _ from 'lodash';\nimport * as PropTypes from 'prop-types';\nimport * as React from 'react';\n\nimport { HierarchicalTree, HierarchicalTreeProps } from './HierarchicalTree';\nimport { HierarchicalTreeTitle, HierarchicalTreeTitleProps } from './HierarchicalTreeTitle';\nimport {\n  childrenExist,\n  createShorthandFactory,\n  commonPropTypes,\n  UIComponentProps,\n  ChildrenComponentProps,\n  rtlTextContainer,\n} from '../../utils';\nimport {\n  ComponentEventHandler,\n  ShorthandRenderFunction,\n  ShorthandValue,\n  ShorthandCollection,\n  FluentComponentStaticProps,\n} from '../../types';\n\nexport interface HierarchicalTreeItemSlotClassNames {\n  subtree: string;\n}\n\nexport interface HierarchicalTreeItemProps extends UIComponentProps, ChildrenComponentProps {\n  /** Accessibility behavior if overridden by the user. */\n  accessibility?: Accessibility<HierarchicalTreeItemBehaviorProps>;\n\n  /** Only allow one subtree to be open at a time. */\n  exclusive?: boolean;\n\n  /** The index of the item among its sibbling */\n  index?: number;\n\n  /** Array of props for sub tree. */\n  items?: ShorthandValue<HierarchicalTreeProps> | ShorthandCollection<HierarchicalTreeItemProps>;\n\n  /** Called when a tree title is clicked. */\n  onTitleClick?: ComponentEventHandler<HierarchicalTreeItemProps>;\n\n  /** Whether or not the subtree of the item is in the open state. */\n  open?: boolean;\n\n  /**\n   * A custom render iterator for rendering each Accordion panel title.\n   * The default component, props, and children are available for each panel title.\n   *\n   * @param Component - The computed component for this slot.\n   * @param props - The computed props for this slot.\n   * @param children - The computed children for this slot.\n   */\n  renderItemTitle?: ShorthandRenderFunction<HierarchicalTreeTitleProps>;\n\n  /** Properties for TreeTitle. */\n  title?: ShorthandValue<HierarchicalTreeTitleProps>;\n}\n\nexport const hierarchicalTreeItemClassName = 'ui-hierarchicaltree__item';\nexport const hierarchicalTreeItemSlotClassNames: HierarchicalTreeItemSlotClassNames = {\n  subtree: `${hierarchicalTreeItemClassName}__subtree`,\n};\n\nexport type HierarchicalTreeItemStyles = never;\n\n/**\n * A TreeItem renders an item of a Tree.\n *\n * @accessibility\n * Implements [ARIA TreeView](https://www.w3.org/TR/wai-aria-practices-1.1/#TreeView) design pattern.\n */\nexport const HierarchicalTreeItem: ComponentWithAs<'li', HierarchicalTreeItemProps> &\n  FluentComponentStaticProps<HierarchicalTreeItemProps> = props => {\n  const context = useFluentContext();\n  const { setStart, setEnd } = useTelemetry(HierarchicalTreeItem.displayName, context.telemetry);\n  setStart();\n  const { items, title, renderItemTitle, open, exclusive, children, className, design, styles, variables } = props;\n  const ElementType = getElementType(props);\n  const unhandledProps = useUnhandledProps(HierarchicalTreeItem.handledProps, props);\n\n  const actionHandlers = {\n    performClick: e => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      _.invoke(props, 'onTitleClick', e, props);\n    },\n    receiveFocus: e => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      // Focuses the title if the event comes from a child item.\n      if (eventComesFromChildItem(e)) {\n        itemRef.current.focus();\n      }\n    },\n    collapse: e => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      // Handle click on title if the keyboard event was dispatched on that title\n      if (!eventComesFromChildItem(e)) {\n        handleTitleClick(e);\n      }\n    },\n    expand: e => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      handleTitleClick(e);\n    },\n    focusSubtree: e => {\n      e.preventDefault();\n      e.stopPropagation();\n\n      const element = getFirstFocusable(treeRef.current, treeRef.current, true);\n      if (element) {\n        element.focus();\n      }\n    },\n  };\n  const getA11yProps = useAccessibility<HierarchicalTreeItemBehaviorProps>(props.accessibility, {\n    debugName: HierarchicalTreeItem.displayName,\n    actionHandlers,\n    mapPropsToBehavior: () => ({\n      hasItems: items && !!(items as HierarchicalTreeItemProps[]).length,\n      open,\n    }),\n    rtl: context.rtl,\n  });\n\n  const itemRef = React.useRef<HTMLElement>();\n  const treeRef = React.useRef<HTMLElement>();\n\n  const { classes } = useStyles<HierarchicalTreeItemStyles>(HierarchicalTreeItem.displayName, {\n    className: hierarchicalTreeItemClassName,\n    mapPropsToInlineStyles: () => ({\n      className,\n      design,\n      styles,\n      variables,\n    }),\n    rtl: context.rtl,\n  });\n\n  const eventComesFromChildItem = e => {\n    return e.currentTarget !== e.target;\n  };\n\n  const handleTitleClick = e => {\n    _.invoke(props, 'onTitleClick', e, props);\n  };\n\n  const handleTitleOverrides = (predefinedProps: HierarchicalTreeTitleProps) => ({\n    onClick: (e, titleProps) => {\n      handleTitleClick(e);\n      _.invoke(predefinedProps, 'onClick', e, titleProps);\n    },\n  });\n\n  const renderContent = () => {\n    const hasSubtree = !_.isNil(items);\n\n    return (\n      <>\n        {HierarchicalTreeTitle.create(title, {\n          defaultProps: () => ({\n            open,\n            hasSubtree,\n            as: hasSubtree ? 'span' : 'a',\n          }),\n          render: renderItemTitle,\n          overrideProps: handleTitleOverrides,\n        })}\n        {hasSubtree && open && (\n          <Ref innerRef={treeRef}>\n            {HierarchicalTree.create(items, {\n              defaultProps: () =>\n                getA11yProps('item', {\n                  accessibility: hierarchicalSubtreeBehavior,\n                  className: hierarchicalTreeItemSlotClassNames.subtree,\n                  exclusive,\n                  renderItemTitle,\n                }),\n            })}\n          </Ref>\n        )}\n      </>\n    );\n  };\n\n  const element = (\n    <Ref innerRef={itemRef}>\n      <ElementType\n        {...getA11yProps('root', {\n          className: classes.root,\n          ...unhandledProps,\n          ...rtlTextContainer.getAttributes({ forElements: [children] }),\n        })}\n      >\n        {childrenExist(children) ? children : renderContent()}\n      </ElementType>\n    </Ref>\n  );\n\n  setEnd();\n  return element;\n};\n\nHierarchicalTreeItem.displayName = 'HierarchicalTreeItem';\n\nHierarchicalTreeItem.propTypes = {\n  ...commonPropTypes.createCommon({\n    content: false,\n  }),\n  items: customPropTypes.collectionShorthand,\n  index: PropTypes.number,\n  exclusive: PropTypes.bool,\n  onTitleClick: PropTypes.func,\n  open: PropTypes.bool,\n  renderItemTitle: PropTypes.func,\n  title: customPropTypes.itemShorthand,\n};\n\nHierarchicalTreeItem.defaultProps = {\n  as: 'li',\n  accessibility: hierarchicalTreeItemBehavior,\n};\n\nHierarchicalTreeItem.handledProps = Object.keys(HierarchicalTreeItem.propTypes) as any;\n\nHierarchicalTreeItem.create = createShorthandFactory({\n  Component: HierarchicalTreeItem,\n  mappedProp: 'title',\n});\n"],"file":"HierarchicalTreeItem.js"}
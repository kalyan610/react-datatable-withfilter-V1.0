/**
 * SharePoint Framework support for customizing the list view.
 *
 * @packagedocumentation
 */

import { BaseExtension } from '@microsoft/sp-extension-base';
import { ExtensionContext } from '@microsoft/sp-extension-base';
import { ICommandSetExtensionManifest } from '@microsoft/sp-module-interfaces';
import { SPEvent } from '@microsoft/sp-core-library';
import { SPEventArgs } from '@microsoft/sp-core-library';
import { SPField } from '@microsoft/sp-page-context';

/**
 * This is the base class that third parties should extend when implementing
 * a client-side extension that customizes the appearance of fields in
 * a SharePoint ListView.
 *
 * In the component manifest, the "extensionType" should be set to "FieldCustomizer".
 *
 * @public
 */
export declare abstract class BaseFieldCustomizer<TProperties> extends BaseExtension<TProperties> {
    /**
     * {@inheritDoc @microsoft/sp-component-base#BaseComponent.context}
     */
    protected readonly context: FieldCustomizerContext;
    onRenderCell(event: IFieldCustomizerCellEventParameters): void;
    onDisposeCell(event: IFieldCustomizerCellEventParameters): void;
}

/**
 * This is the base class that third parties should extend when implementing
 * a client-side extension that provides a command set for a SharePoint list view.
 *
 * @remarks
 * In the component manifest, the "extensionType" should be set to "ListViewCommandSet".
 *
 * @privateRemarks
 *
 * Eventually other command set classes will be introduced, and then we will introduce a base class
 * so the hierarchy goes `BaseListViewCommandSet <- BaseCommandSet <- BaseExtension <- BaseComponent`.
 *
 * @public
 */
export declare abstract class BaseListViewCommandSet<TProperties> extends BaseExtension<TProperties> {
    /**
     * {@inheritDoc @microsoft/sp-extension-base#BaseExtension.context}
     */
    readonly context: ListViewCommandSetContext;
    /* Excluded from this release type: __constructor */
    /**
     * Returns the command with the given id.
     * Returns undefined if there is not command with the given id.
     * @param id - Id of the command
     */
    tryGetCommand(id: string): Command;
    /**
     * This event occurs whenever the ListView state changes.
     * @remarks
     * This event allows the implementor to tailor the appearance of the command.
     * For example, to hide the command, assign its property visible = false.
     * To customize the title, modify the command property title.
     */
    onListViewUpdated(event: IListViewCommandSetListViewUpdatedParameters): void;
    /**
     * This event occurs when the command is invoked, e.g. because the user
     * clicked on the toolbar button or menu item.
     */
    onExecute(event: IListViewCommandSetExecuteEventParameters): void;
}

/**
 * Provides access to a ListView column, which is the visual presentation
 * of a field.
 *
 * @remarks
 *
 * A SharePoint "field" (SPField) defines the data storage for a property of a list item.
 * (If the list item represents a document, then the field is sometimes called a "property".)
 *
 * A "column" is the visual presentation of a field, when displayed by the ListView.
 *
 * @public
 */
export declare abstract class ColumnAccessor {
    /* Excluded from this release type: __constructor */
    /**
     * The server-side definition of the field.
     * This property is read-only.
     */
    abstract readonly field: SPField;
    /**
     * Whether to show this column in the list view.
     * This property is read-only.
     */
    abstract readonly visible: boolean;
}

/**
 * Represents a command belonging to a command set.
 *
 * @remarks
 * The BaseListViewCommandSet extension type exposes generalized commands that may be displayed as tool bar buttons,
 * context menu items, etc. These commands are initially defined in the extension’s manifest file. At runtime, the
 * corresponding Command object can be obtained by calling {@link BaseListViewCommandSet.tryGetCommand}.
 * The command’s appearance can be customized by assigning its properties, for example to hide a command that is not
 * contextually relevant, or to pluralize the title based on the number of selected items.
 * @public
 */
export declare class Command {
    /**
     * Id of the command.
     */
    id: string;
    /**
     * A short label to be displayed by the associated button, menu item, etc.
     * @remarks
     * Example: "Show information"
     *
     * Altering the title property is intended to allow minor changes to the title, e.g. “Submit these 3 items” or
     * toggling between “Schedule” and “Unschedule”. Developers are discouraged from assigning a title that radically
     * alters the meaning of the command, because administrators should be able to examine the extension manifest to
     * understand which commands are being implemented by a given extension.
     */
    title: string;
    /**
     * An optional URL for an image to be displayed next to the command. The requirements for this image
     * are defined by the type of extension; some extension types may not display the image at all.
     *
     * @remarks
     * This must be a absolute URL.
     */
    iconImageUrl: string | undefined;
    /**
     * Custom accessibility text for the browser's "aria-label" attribute.  If omitted, the title property
     * will be used by default.
     * Example: "Show information.  Press ENTER to select."
     */
    ariaLabel: string | undefined;
    /**
     * True if the command is visible.
     */
    visible: boolean;
}

/**
 * This object provides contextual information for BaseFieldCustomizer.
 * @public
 */
export declare class FieldCustomizerContext extends ExtensionContext {
    private _listView;
    private _field;
    /* Excluded from this release type: __constructor */
    /**
     * If the field customizer is bounded to the SharePoint list view, this provides access
     * to the list view specific functionality; otherwise the value is undefined.
     *
     * @remarks
     * Although the SharePoint list view is the main usage scenario, field customizers
     * can be used by other user interface surfaces.  For example, in the future SharePoint
     * may support field customizers on a display/edit form.
     *
     * @returns the SharePoint list view, or undefined if there is none.
     */
    tryGetListView(): ListViewAccessor | undefined;
    /**
     * Provides access to the SharePoint field that the customizer will operate on.
     */
    readonly field: SPField;
}

/* Excluded from this release type: _IExtensionContextParameters */

/**
 * Event parameters for BaseFieldCustomizer.onRenderCell()
 * @public
 */
export declare interface IFieldCustomizerCellEventParameters {
    /**
     * The HTML "div" element that the extension will take ownership of.
     * This ownership will end when onDisposeCell() is called.
     */
    readonly domElement: HTMLDivElement;
    /**
     * The list item being edited.
     */
    readonly listItem: ListItemAccessor;
    /**
     * The value of the field being rendered.
     */
    readonly fieldValue: any;
    /**
     * An implementation defined storage property.
     *
     * @remarks
     * For example, suppose that resources need to be allocated during rendering
     * (e.g. a renderer object, an HTTP request to be canceled, a cache slot, etc).
     * The onRenderCell() implementation could store a key or handle in this property,
     * and then onDisposeCell() can use this key to find the resource to be freed.
     */
    userData: any;
}

/* Excluded from this release type: _IFieldCustomizerContextParameters */

/* Excluded from this release type: _IListViewCommandSetContextParameters */

/**
 * Parameters for {@link BaseListViewCommandSet.onExecute}
 *
 * @public
 */
export declare interface IListViewCommandSetExecuteEventParameters {
    /**
     * The unique identifier for the command.  This is specified as ICommandDefinition.commandId
     * in the component manifest.
     */
    readonly itemId: string;
    /**
     * The currently selected ListView rows, at the time when the event occurred.
     */
    readonly selectedRows: ReadonlyArray<RowAccessor>;
}

/**
 * Parameters for {@link BaseListViewCommandSet.onListViewUpdated}
 *
 * @public
 */
export declare interface IListViewCommandSetListViewUpdatedParameters {
    /**
     * The currently selected ListView rows, at the time when the event occurred.
     */
    readonly selectedRows: ReadonlyArray<RowAccessor>;
}

/**
 * When a field customizer extension is rendering a field, the ListItemAccessor provides
 * access to the associated SharePoint list item.
 *
 * @remarks
 *
 * ListItemAccessor allows a field customizer extension to determine which fields are available
 * in the editor and retrieve the current values for those fields.  In the future, it may
 * also support validation and editing operations.
 *
 * When the editor is the SharePoint list view, the ListViewAccessor uses the RowAccessor
 * subclass instead of the ListItemAccessor base class.  This allows additional functionality
 * to be exposed, for example determining whether the associated table row is selected or not.
 *
 * @public
 */
export declare abstract class ListItemAccessor {
    /* Excluded from this release type: __constructor */
    /**
     * The SharePoint fields that are currently available in the editor for this list item.
     *
     * @remarks
     * The set of available fields depends on the editing context.  For example, if a list view
     * column is hidden, the corresponding field definition may not be loaded.  Field customizers
     * should not assume that a given field will be available, even if it is defined in the
     * content type.
     */
    abstract readonly fields: ReadonlyArray<SPField>;
    /**
     * Retrieves the current data value for the field with the specified internal name.
     * The value will be a primitive JavaScript object such as a string, number, etc.
     */
    abstract getValueByName(internalName: string): any;
    /**
     * Retrieves the current data value for the specified field.
     * The value will be a primitive JavaScript object such as a string, number, etc.
     */
    abstract getValue(field: SPField): any;
}

/**
 * Provides access to a SharePoint ListView control.
 *
 * @public
 */
export declare abstract class ListViewAccessor {
    /* Excluded from this release type: _selectedRowsChangedEventName */
    private _selectedRowsChangedEvent;
    /* Excluded from this release type: __constructor */
    /**
     * The columns in associated with this view, including hidden columns.
     */
    abstract readonly columns: ReadonlyArray<ColumnAccessor>;
    /**
     * Returns the list view column corresponding to the field with the specified internal name,
     * or undefined if none is found.
     */
    abstract tryGetColumnByName(internalName: string): ColumnAccessor | undefined;
    /**
     * Event that gets raised every time the selected items in the list view change.
     * @eventproperty
     */
    readonly selectedRowsChangedEvent: SPEvent<SelectedRowsChangedEventArgs>;
}

/**
 * This object provides contextual information for BaseListViewCommandSet.
 * @public
 */
export declare class ListViewCommandSetContext extends ExtensionContext {
    /**
     * {@inheritDoc @microsoft/sp-component-base#BaseComponentContext.manifest}
     */
    readonly manifest: ICommandSetExtensionManifest;
    private _listView;
    private _commandArray;
    /* Excluded from this release type: __constructor */
    /**
     * Provides access to the ListView control that the customizer will operate on.
     */
    readonly listView: ListViewAccessor;
    /* Excluded from this release type: _commands */
}

/**
 * Provides access to a ListView row, which is the visual presentation
 * of a SharePoint list item.
 *
 * @remarks
 *
 * A SharePoint "list item" (SPListItem) is a data storage record in the content
 * management system; it stores an array of values for the associated fields.
 *
 * A "row" is the visual presentation of a list item, when displayed by the ListView;
 * it stores an array of cell values for the associated columns.
 *
 * @public
 */
export declare abstract class RowAccessor extends ListItemAccessor {
    /* Excluded from this release type: __constructor */
}

/**
 * Arguments for the selected rows changed event.
 *
 * @public
 */
export declare class SelectedRowsChangedEventArgs extends SPEventArgs {
    /**
     * The list of rows that were selected in the list view at the time when the event was fired.
     */
    selectedRows: ReadonlyArray<RowAccessor>;
}

export { }
